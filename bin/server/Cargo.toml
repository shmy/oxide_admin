[package]
name = "server"
version = "0.1.0"
edition = "2024"

[[bin]]
name = "server"
path = "main.rs"

[lib]
path = "lib.rs"

[dependencies]
anyhow = { workspace = true }
clap = { workspace = true, features = [
    "std",
    "help",
    "env",
    "derive",
    "error-context",
] }
tokio = { workspace = true, features = ["full"] }
axum = { workspace = true }
dotenvy = { workspace = true }
chrono-tz = { workspace = true }
mimalloc = { workspace = true }
humantime = { workspace = true }
tracing = { workspace = true }
tracing-appender = { workspace = true }
tracing-subscriber = { workspace = true, features = [
    "fmt",
    "ansi",
    "env-filter",
    "json",
] }

adapter = { workspace = true }
application = { workspace = true }
infrastructure = { workspace = true }
faktory_bg = { workspace = true }

[features]
default = ["redis", "faktory"]
redb = ["infrastructure/redb"]
redis = ["infrastructure/redis"]
faktory = ["infrastructure/faktory"]
