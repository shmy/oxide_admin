[package]
name = "infrastructure"
version = "0.1.0"
edition = "2024"

[lib]
path = "lib.rs"

[features]
kv_redb = ["dep:redb"]
kv_redis = ["dep:bb8-redis"]
bg_faktory = ["bg_worker/faktory"]
bg_dummy = ["bg_worker/dummy"]
object_storage_fs = ["object_storage/fs"]
object_storage_s3 = ["object_storage/s3"]

[dependencies]
anyhow = { workspace = true }
bb8-redis = { workspace = true, optional = true }
bg_worker = { workspace = true }
bon = { workspace = true }
captcha_generator = { workspace = true }
chrono = { workspace = true }
chrono-tz = { workspace = true, features = ["std"] }

domain = { workspace = true }
jsonwebtoken = { workspace = true }
nject = { workspace = true, features = ["macro"] }
object_storage = { workspace = true }
readonly = { workspace = true }
redb = { workspace = true, optional = true }
rmp-serde = { workspace = true }
serde = { workspace = true, features = ["derive"] }
serde_json = { workspace = true, features = ["std"] }
single_flight = { workspace = true }
sqlx = { workspace = true, features = [
    "runtime-tokio",
    "postgres",
    "macros",
    "migrate",
    "chrono",
    "json",
    "derive",
] }
tempoid = { workspace = true }
tokio = { workspace = true, features = ["full"] }
tracing = { workspace = true }
tracing-appender = { workspace = true }
